<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
    
   function validate(datum){
    let geburtsdatum = document.getElementsByName("geburtsdatum")[0].value; 
            
    switch(datum){
        case "geburtstag":
          if(getDiffAkt(geburtsdatum) <= 0) alert("Das Geburtsdatum muss in der Vergangenheit liegen!");
          break;
        case "einschulung":
          let einschulungsdatum = document.getElementsByName("einschulungsdatum")[0].value;
          //let geburtsdatum = document.getElementsByName("geburtsdatum")[0].value;
          let diff = getDiff(geburtsdatum, einschulungsdatum);
          if(getDiff(geburtsdatum, einschulungsdatum) < 5) alert("Sie müssen bei Ihrer Einschulung mindestens 5 Jahre alt gewesen sein!");
          break;
        case "fuehrerschein": 
          let fuehrerscheinSeit = document.getElementsByName("fuehrerscheinSeit")[0].value;
          if(fuehrerscheinSeit){
            if(getDiff(geburtsdatum, fuehrerscheinSeit) < 17) alert("Für Ihren Führerschein müssen sie mindestens 17 sein!");
          } 
          break;
      }
    }

    function getDiff(datum, datum2){
      datum2 = toDate(datum2);
      datum = toDate(datum);
      
      let diff = Math.abs(datum2 - datum);
      diff /= (1000 * 3600 * 24 * 365)
      diff = (datum2<datum) ? diff*(-1) : diff;
      return diff;
  }

  function getDiffAkt(datum){
    let aktDatum = new Date();
    
    aktDatum.setHours = 0;
    aktDatum.setMilliseconds = 0;
    aktDatum.setMinutes = 0;
    datum = toDate(datum);
    
    let diff = Math.abs(aktDatum - datum);
    diff /= (1000 * 3600 * 24 * 365)
    diff = (aktDatum<datum) ? diff*(-1) : diff;
    return diff;
  }

  function toDate(datum){
    let tag = parseInt(datum.substring(8,10));
    let monat = parseInt(datum.substring(5,7));
    let jahr = parseInt(datum.substring(0,4));
    let nDatum = new Date(jahr, monat-1, tag);
    return nDatum;
  }
    </script>
    <title>Registrierung</title>
  </head>
  <body>
    <div class="jumbotron text-center">
      <h1>Datumseingaben</h1>
      <p>Bitte geben Sie einige Daten aus Ihrem Lebenslauf ein!</p>
    </div>
    <div class="container">
      <form action="DatumseingabenVerarbeiten.php" method="get" id="formular">
        <div class="form-group">
          <label for="geburtsdatum">Geburtsdatum: </label><br/>
          <input type="date" name="geburtsdatum" class="form-control" size="10" maxlength="10" onblur="validate('geburtstag')">
        </div>
        <div class="form-group">
          <label for="einschulungsdatum">Datum der Einschulung: </label>
          <input name="einschulungsdatum" type="date" class="form-control" size="10" maxlength="10" onblur="validate('einschulung')">
        </div>
        <div class="form-group">
          <label for="fuehrerscheinSeit">PKW-Führerschein seit:* </label>
          <input name="fuehrerscheinSeit" type="date" class="form-control" size="10" maxlength="10" onblur="validate('fuehrerschein')">
        </div>
        <input type="submit" value="Absenden" id="senden" class="btn btn-primary">
        <input class="btn btn-secondary" type="reset">
      </form>
    </div>
  </body>
</html>
